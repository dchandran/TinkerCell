SET(LIBRARY_OUTPUT_PATH ${CPP_LIBRARY_OUTPUT_PATH})

SET( TINKERCELL_CORE_HDRS
  ../Core/MainWindow.h 
  ../Core/NetworkWindow.h
  ../Core/CodeEditor.h 
  ../Core/TextEditor.h 
  ../Core/GraphicsScene.h 
  ../Core/Tool.h 
  ../Core/TextItem.h 
  ../Core/ItemHandle.h 
  ../Core/ItemFamily.h
  ../BasicTools/EquationParser.h
  )
  
ADD_DEFINITIONS(${QT_DEFINITIONS})
ADD_DEFINITIONS(-DQT_PLUGIN)
ADD_DEFINITIONS(-DQT_NO_DEBUG)
ADD_DEFINITIONS(-DQT_SHARED)

FILE( GLOB TINKERCELL_PLOT_SRC Plot*.cpp ../ModelingTools/EquationParser.cpp)
FILE( GLOB TINKERCELL_PLOT_HDRS Plot*.h )
  
FILE( GLOB TINKERCELL_QWT_HDRS ${TINKERCELL_SOURCE_DIR}/ExternalCode/qwt/*.h)
FILE( GLOB TINKERCELL_QWT3D_HDRS ${TINKERCELL_SOURCE_DIR}/ExternalCode/qwtplot3d/include/*.h)

QT4_WRAP_CPP( QWT_MOC_SRC ${TINKERCELL_QWT_HDRS} ${TINKERCELL_QWT3D_HDRS} )
QT4_WRAP_CPP( TINKERCELL_PLOT_MOC_SRC ${TINKERCELL_PLOT_HDRS} )
QT4_WRAP_CPP( TINKERCELL_CORE_MOC_SRC ${TINKERCELL_CORE_HDRS} )

ADD_LIBRARY( PlotTool 
 SHARED
  ${QWT_MOC_SRC}
 ${TINKERCELL_PLOT_MOC_SRC}
  ${TINKERCELL_CORE_MOC_SRC}
  ${TINKERCELL_PLOT_SRC}
)

TARGET_LINK_LIBRARIES( PlotTool
  PlotTool
  qwt
  qwtplot3d
  TinkerCellCore
)

FILE( GLOB TINKERCELL_GNUPLOT_SRC GnuplotTool.cpp)
FILE( GLOB TINKERCELL_GNUPLOT_HDRS GnuplotTool.h)
  
QT4_WRAP_CPP( TINKERCELL_GNUPLOT_MOC_SRC ${TINKERCELL_GNUPLOT_HDRS} )

ADD_LIBRARY( GnuplotTool 
 SHARED
  ${TINKERCELL_GNUPLOT_MOC_SRC}
  ${TINKERCELL_CORE_MOC_SRC}
  ${TINKERCELL_GNUPLOT_SRC}
)

TARGET_LINK_LIBRARIES( GnuplotTool
 GnuplotTool
 TinkerCellCore
)

IF ( WIN32 )
  INSTALL(TARGETS PlotTool DESTINATION Plugins)
  INSTALL(TARGETS GnuplotTool DESTINATION Plugins)
ELSE ( WIN32 )
  INSTALL(TARGETS PlotTool LIBRARY DESTINATION Plugins)
  INSTALL(TARGETS GnuplotTool DESTINATION Plugins)
ENDIF( WIN32 )

